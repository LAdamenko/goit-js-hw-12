{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImges(query, currentPage) {\n    const url = `https://pixabay.com/api/`;\n    const params = {\n        key: '43018161-f974b102273f6260f6ed159b0',\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        page: currentPage,\n        per_page: 15,\n    };\n    try {\n        const res = await axios.get(url, { params });\n        return res.data;\n    } catch (err) {\n        iziToast.error({\n                    color: 'red',\n                    message: `❌ Sorry, there was a mistake. Please try again!`,\n                    position: 'topRight',\n                });\n    }\n}\n\n","function imgTemplate(data) {\n    const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = data;\n    return `<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            width=\"360\"\n            height=\"200\"\n            class=\"gallery-img\"\n        />\n        <ul class=\"gallery-description\">\n        <li class=\"gallery-description-item\"><h3>Likes</h3><p>${likes}</p></li>\n        <li class=\"gallery-description-item\"><h3>Views</h3><p>${views}</p></li>\n        <li class=\"gallery-description-item\"><h3>Comments</h3><p>${comments}</p></li>\n        <li class=\"gallery-description-item\"><h3>Downloads</h3><p>${downloads}</p></li>\n     </ul>\n\t</a>\n</li>`;\n}\n\nexport function imagesTemplate(arr) {\n  return arr.map(imgTemplate).join('');\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getImges } from \"./js/pixabay-api\";\nimport { imagesTemplate } from \"./js/render-functions\";\n\nconst refs = {\n  formEl: document.querySelector('.input-form'),\n  infoEl: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.load-btn'),\n  card: document.querySelector(\".gallery\"),\n};\n\nlet query;\nlet currentPage = 1;\nlet maxPage = 0;\nconst per_page = 15;\nconst loader = document.querySelector('.loader');\n\nrefs.formEl.addEventListener(\"submit\", async e => {\n    e.preventDefault();\n    \n    query = refs.formEl.elements.query.value;\n    currentPage = 1;\n\n    if (query === \"\") {\n        iziToast.warning({\n            color: 'yellow',\n            message: 'You forgot to describe the image',\n            position: 'topRight',\n        });\n      refs.infoEl.innerHTML = \"\";\n    } else {\n        refs.infoEl.innerHTML = \"\";\n        loader.classList.remove('is-hidden');\n        try {\n            const data = await getImges(query, currentPage);\n            maxPage = Math.ceil(data.totalHits / per_page);\n            const markup = imagesTemplate(data.hits);\n            refs.infoEl.innerHTML = markup;\n                \n                const lightbox = new SimpleLightbox('.gallery-link', {\n                    captionsData: 'alt',\n                    captionDelay: 250,\n                    overlayOpacity: 0.8,\n                });\n                lightbox.refresh();\n\n                if (!markup.length) {\n                    iziToast.error({\n                        color: 'red',\n                        message: `❌ Sorry, there are no images matching your search query. Please try again!`,\n                        position: 'topRight',\n                    });\n                    loader.classList.add('is-hidden');\n                }\n        } catch (err) {\n            iziToast.error({\n                    color: 'red',\n                    message: `❌ Sorry, there was a mistake. Please try again!`,\n                    position: 'topRight',\n                });\n                refs.infoEl.innerHTML = '';\n        } finally {\n            loader.classList.add('is-hidden');\n            checkBtnStatus();\n            };        \n    }\n});\n\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  loader.classList.remove('is-hidden');\n  try {\n    const data = await getImges(query, currentPage);\n    const markup = imagesTemplate(data.hits);\n    refs.infoEl.insertAdjacentHTML('beforeend', markup);\n    \n    const lightbox = new SimpleLightbox('.gallery-link', {\n                    captionsData: 'alt',\n                    captionDelay: 250,\n                    overlayOpacity: 0.8,\n                });\n                lightbox.refresh();\n  } catch (err) {\n    iziToast.error({\n                    color: 'red',\n                    message: `❌ Sorry, there was a mistake. Please try again!`,\n                    position: 'topRight',\n                });\n                refs.infoEl.innerHTML = '';\n  }\n\n  myScroll();\n  checkBtnStatus();\n  loader.classList.add('is-hidden');\n}\n\nfunction checkBtnStatus() {\n  if (currentPage >= maxPage) {\n    refs.btnLoadMore.classList.add('is-hidden');\n    iziToast.info({\n            color: 'blue',\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: 'bottomCenter',\n        });\n  } else {\n    refs.btnLoadMore.classList.remove('is-hidden');\n  }\n}\n\nfunction myScroll() {\n  const height = refs.card.firstChild.getBoundingClientRect().height * 2;\n  scrollBy({\n    top: height,\n    behavior: 'smooth',\n  });\n}"],"names":["getImges","query","currentPage","url","params","axios","imgTemplate","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesTemplate","arr","refs","maxPage","per_page","loader","e","iziToast","markup","SimpleLightbox","checkBtnStatus","onLoadMoreClick","myScroll","height"],"mappings":"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"}